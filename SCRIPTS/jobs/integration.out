
R version 3.5.2 (2018-12-20) -- "Eggshell Igloo"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R es un software libre y viene sin GARANTIA ALGUNA.
Usted puede redistribuirlo bajo ciertas circunstancias.
Escriba 'license()' o 'licence()' para detalles de distribucion.

R es un proyecto colaborativo con muchos contribuyentes.
Escriba 'contributors()' para obtener más información y
'citation()' para saber cómo citar R o paquetes de R en publicaciones.

Escriba 'demo()' para demostraciones, 'help()' para el sistema on-line de ayuda,
o 'help.start()' para abrir el sistema de ayuda HTML con su navegador.
Escriba 'q()' para salir de R.

> library(Seurat)
> library(ggplot2)
> #library(ggpubr)
> 
> #>> Work directory and seed
> 
> setwd("/datos_2/FANCONI")
> set.seed(1234567)
> 
> #Fanconi_2008<-readRDS("DATA/Fanconi_2008/CD34/fanconi.RDS")
> #
> #Fanconi_2008$Sample<-"fanconi_2008"
> #
> #Fanconi_2004<-readRDS("DATA/fanconi_eltrombopag.RDS")
> #Fanconi_2004$Sample<-"fanconi_2004"
> #
> #Fanconi_2006<-readRDS("DATA/fanconi_updated.RDS")
> #
> #Fanconi_2006$Sample<-"fanconi_2006"
> #
> #Fanconi_2002<-readRDS("DATA/fancon_2002.rds")
> #
> #Fanconi_2002$Sample<-"fanconi_2002"
> 
> 
> 
> Fanconi<-readRDS("DATA/4_integrated.RDS")
> Fanconi$Project<-"Fanconi"
> 
> Healthy<-readRDS("DATA/mo268_names.rds")
> Healthy$Project<-"Healthy"
> 
> 
> #>> INTEGRATION
> library(future)
> plan("multiprocess", workers = 4)
> options(future.globals.maxSize = 10000 * 1024^2)
> 
> combined.list <- c(Fanconi, Healthy)
> 
> for (i in 1:length(combined.list)) {
+   combined.list[[i]] <- SCTransform(combined.list[[i]], verbose = FALSE,vars.to.regress = c("percent.mt","nFeature_RNA"))
+ }
There were 50 or more warnings (use warnings() to see the first 50)
> 
> fanconi.features <- SelectIntegrationFeatures(object.list = combined.list, nfeatures = 3000)
> 
> 
> combined.list <- PrepSCTIntegration(object.list = combined.list, anchor.features = fanconi.features, 
+                                     verbose = FALSE)
> 
> combined.anchors <- FindIntegrationAnchors(object.list = combined.list, normalization.method = "SCT", 
+                                            anchor.features = fanconi.features, verbose = FALSE)
> 
> 
> fanconi.integrated <- IntegrateData(anchorset = combined.anchors, normalization.method = "SCT", 
+                                      verbose = FALSE)
Warning: Adding a command log without an assay associated with it
>                                      
> saveRDS(fanconi.integrated, file="DATA/4_fanconi_healthy.RDS")
> 
> proc.time()
    user   system  elapsed 
2536.144  400.333 2128.019 
